from src.dataAccesAPI.objectsAPI.util import remove_empty_values
from src.dataAccesAPI.objectsAPI.vulnerabilityAPI.CVEAPI import get_CVE_by_id
from src.dataAccesAPI.objectsAPI.vulnerabilityAPI.CWEAPI import get_CWE_by_id

def get_type_of_vulnerability(id: str):
    """
    This function gets the type of the vulnerability
    Args:
        id (str): id of the vulnerability
    Returns:
        str: type of the vulnerability
    """
    if id[:3].lower() == ('CVE').lower():
        return 'CVE'
    elif id[:3].lower() == ('CWE').lower():
        return 'CWE'
    
    
def get_vulnerability_from_id(id: str):
    """
    This function gets the vulnerability from the id

    Args:
        id (str): id of the vulnerability

    Returns:
        dict: dictionary with the vulnerability info
    """
    vuln_type = get_type_of_vulnerability(id)

    if vuln_type == 'CVE':
        return get_CVE_by_id(id)    
    elif vuln_type == 'CWE':
        return get_CWE_by_id(id)
    else:
        return {}
    