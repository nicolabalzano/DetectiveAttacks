from stix2.v20 import CourseOfAction

from src.dataProvider.interfaceToCTI.stixData.stixRetriever._AbstractCreateObjectFromSTIX import _AbstractCreateObjectFromSTIX
from src.dataProvider.domain.mySTIXObject.MyCourseOfAction import MyCourseOfAction
from src.dataProvider.utils.Singleton import singleton


@singleton
class CourseOfActionRetriever(_AbstractCreateObjectFromSTIX):

    def __init__(self):
        super().__init__(MyCourseOfAction, CourseOfAction)

    def get_my_courses_of_action(self, stix_object: CourseOfAction) -> MyCourseOfAction:
        return self._get_object_from_stix(stix_object['object'])
