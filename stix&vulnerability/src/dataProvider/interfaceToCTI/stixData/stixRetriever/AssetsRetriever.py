from typing import List

from mitreattack.stix20 import Asset

from src.dataProvider.domain.mySTIXObject.MyAsset import MyAsset
from src.dataProvider.interfaceToCTI.stixData.stixRetriever._AbstractObjectWithAttackPatternRetriever import \
    _AbstractObjectWithAttackPatternsRetriever
from src.dataProvider.interfaceToCTI.CTIdata import MITRE_ATTACK_ICS_DATA


class AssetRetriever(_AbstractObjectWithAttackPatternsRetriever):

    def __init__(self):
        super().__init__(MyAsset, Asset)

    def _get_all(self):
        return MITRE_ATTACK_ICS_DATA.get_assets(remove_revoked_deprecated=False)

    def get_attack_patterns_relationship_using_objects_id(self, object_stix_id: str) -> List:
        return MITRE_ATTACK_ICS_DATA.get_techniques_targeting_asset(object_stix_id)
