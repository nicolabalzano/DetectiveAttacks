from pypdf import PdfReader 

def __extract_text_from_pdf(pdf_path):
    pdf = PdfReader(pdf_path)
    text = ''
    for page in pdf.pages:
        text += page.extract_text()
    return text

def check_pdf_for_regular_expressions(file_path, regular_expression):
    vulnerabilities = []
    text = __extract_text_from_pdf(file_path)
    if not text:
        return vulnerabilities
    matches = regular_expression.findall(text)
    for match in matches:
        vulnerabilities.append(match)
    return vulnerabilities
                    
    