import json
import os


class MitreToVulnerabilityData:

    def __init__(self, filepath: str = None, filepath_history: str = None):

        if os.path.isfile(filepath):
            with open(filepath, 'r') as file:
                dict_file = json.load(file)

            # if there is a history
            if os.path.isfile(filepath_history):
                with open(filepath_history, 'r') as file_history:
                    dict_file_history = json.load(file_history)

                # for duplicate key mapping_objects, union the lists
                self.dict_file = {**dict_file_history, **dict_file,
                                  'mapping_objects': dict_file['mapping_objects'] + dict_file_history['mapping_objects']}

            # if there isn't a history
            else:
                self.dict_file = dict_file

    def get_all(self):
        return self.dict_file
