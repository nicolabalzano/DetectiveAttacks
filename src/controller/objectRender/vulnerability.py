from src.controller.objectRender.util import remove_empty_values
from src.model.container import AttackToCVEContainer


def get_vulnerability_from_cve_id(cve_id: str):
    dict_cve = {}
    list_of_cve = AttackToCVEContainer().get_objects_from_data_by_cve_id("CVE-2019-15976")
    if list_of_cve:
        dict_cve['ID'] = list_of_cve[0]['capability_id']
        dict_cve['Name'] = list_of_cve[0]['capability_description']
        dict_cve['Type'] = 'mapped vulnerability'
        dict_cve['Related Attack Patterns'] = [
            {
                'ID': at.x_mitre_id,
                'Name': at.name,
                'Mapping type': mapping_type,
            }
            for mapping_type, ats in AttackToCVEContainer().get_attack_pattern_by_cve_id(cve_id).items()
            for at in ats
        ]

    return remove_empty_values(dict_cve)
